syntax = "proto3";

package user;
import "google/protobuf/empty.proto";

message Secure {
  string pwd = 1;
  string totp = 2;
}

message SignupRequest {
  string email = 1;
  string pwd = 2;
}

message TotpRequest {
  enum actions {
    ENABLE = 0;
    DISABLE = 1;
  };

  actions action = 1;
  Secure secure = 1;
}

message TotpResponse {
  bytes secret = 1;
}

service UserService {
  rpc Signup(user.SignupRequest) returns (google.protobuf.Empty);
  rpc Verify(google.protobuf.Empty) returns (google.protobuf.Empty);
  rpc Delete(user.Secure) returns (google.protobuf.Empty);
  rpc Totp(user.TotpRequest) returns (user.TotpResponse);
}