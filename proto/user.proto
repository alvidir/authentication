syntax = "proto3";

package user;
import "google/protobuf/empty.proto";

// SignupRequest description
message SignupRequest {
  string email = 1;
  string pwd = 2; // hash of the password
}

// DeleteRequest description
message DeleteRequest {
  string ident = 1; // the user's email
  string pwd = 2;   // hash of the password
  string totp = 3;  // optional time-based one time password 
}

// TFARequest description
message TFARequest {
  enum actions {
    ENABLE = 0;
    DISABLE = 1;
  };

  actions action = 1;
  string pwd = 2;     // hash of the password
  string totp = 3;    // optional time-based one time password 
}

// TFAResponse description
message TFAResponse {
  string uri = 1;   // present if, and only if, the secret was just generated and the server is waiting for confirmation
}

service UserService {
  rpc Signup(user.SignupRequest) returns (google.protobuf.Empty);
  rpc Verify(google.protobuf.Empty) returns (google.protobuf.Empty);
  rpc Delete(user.DeleteRequest) returns (google.protobuf.Empty);
  rpc TFA(user.TFARequest) returns (user.TFAResponse);
}